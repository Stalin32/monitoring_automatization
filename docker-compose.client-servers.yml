services:
  cadvisor:
    image: gcr.io/cadvisor/cadvisor:latest
    container_name: cadvisor_exporter
    restart: unless-stopped
    ports:
    - 7101:8080
    volumes:
    - /:/rootfs:ro
    - /var/run:/var/run:rw
    - /sys:/sys:ro
    - /var/lib/docker/:/var/lib/docker:ro

  systemd_exporter:
    image: prom/systemd-exporter:latest
    container_name: systemd_exporter
    restart: unless-stopped
    ports:
      - 7102:9118
    volumes:
      - /run/systemd/journal:/run/systemd/journal:ro
      - /var/run/dbus:/var/run/dbus:ro
    privileged: true

  postgres_exporter:
    image: prom/postgres-exporter:latest
    container_name: postgres_exporter
    restart: unless-stopped
    ports:
      - "7103:9187" # Порт для экспорта метрик
    environment:
      - POSTGRES_PASSWORD=YOUR_POSTGRES_PASSWORD # Пароль пользователя PostgreSQL
      - POSTGRES_USER=YOUR_POSTGRES_USER # Пользователь PostgreSQL с правами на мониторинг
      - POSTGRES_HOST=YOUR_POSTGRES_HOST # Хост PostgreSQL
      - POSTGRES_PORT=YOUR_POSTGRES_PORT # Порт PostgreSQL

  clickhouse_exporter:
    image: prom/clickhouse-exporter:latest
    container_name: clickhouse_exporter
    restart: unless-stopped
    ports:
      - "7104:9104" # Порт для экспорта метрик
    environment:
      - CLICKHOUSE_URL=http://clickhouse:9000 # URL подключения к ClickHouse (замените на ваш)
      - CLICKHOUSE_USER=default # Пользователь ClickHouse (замените на ваш)
      - CLICKHOUSE_PASSWORD=YOUR_CLICKHOUSE_PASSWORD # Пароль ClickHouse (замените на ваш)

###nginx exporter готов      
  nginx_exporter:
    image: nginx/nginx-prometheus-exporter:1.4.0
    ports:
      - "9113:9113"
    depends_on:
      - nginx
    restart: always
    command:
      - -nginx.scrape-uri  #вот так вводить команды будет точно правильно 
      - http://192.168.0.116:80/nginx_status
    networks:
      - local
      - internal



 kafka_exporter:
    image: prom/kafka-exporter:latest
    container_name: kafka_exporter
    restart: unless-stopped
    ports:
      - "7106:9120" # Порт для экспорта метрик
    environment:
      - KAFKA_BOOTSTRAP_SERVERS=kafka1:9092,kafka2:9092,kafka3:9092 # Адреса брокеров Kafka (замените на ваши)

 redis_exporter:
    image: prom/redis-exporter:latest
    container_name: redis_exporter
    restart: unless-stopped
    ports:
      - "7107:9121" # Порт для экспорта метрик
    environment:
      - REDIS_ADDR=redis:6379 # Адрес Redis (замените на ваш)     

  blackbox_exporter:
    image: prom/blackbox-exporter:latest
    container_name: blackbox_exporter
    restart: unless-stopped
    ports:
      - "7108:9115" # Порт для экспорта метрик
    volumes:
      - ./blackbox.yml:/etc/blackbox_exporter/config.yml # Путь к конфигурационному файлу

  networks:
  internal:
    driver: bridge
  local:
    driver: bridge
